<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LLM ↔ Assembly 기반 1회성 시그니처 인증 — 알고리즘 & 데모</title>
<style>
  body{font-family:Inter,Segoe UI,Helvetica,Arial;margin:18px;color:#0f172a}
  header{display:flex;align-items:center;gap:12px}
  h1{font-size:20px;margin:0}
  .container{display:grid;grid-template-columns:1fr 420px;gap:18px;margin-top:18px}
  .card{background:#fff;border:1px solid #e6eef8;padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.04)}
  pre{background:#0b1220;color:#dbeafe;padding:10px;border-radius:8px;overflow:auto}
  button{padding:8px 12px;border-radius:8px;border:0;background:#2563eb;color:#fff;cursor:pointer}
  svg{width:100%;height:auto}
  .log{height:220px;overflow:auto;background:#0b1220;color:#e6eef8;padding:10px;border-radius:8px}
  .cols{display:flex;gap:10px}
  .small{font-size:13px;color:#334155}
  footer{margin-top:16px;color:#475569;font-size:13px}
</style>
</head>
<body>
<header>
  <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='44' height='44'><rect rx='8' width='44' height='44' fill='%232563eb'/><text x='50%' y='55%' font-size='20' text-anchor='middle' font-family='Arial' fill='white'>A</text></svg>" alt="logo"/>
  <div>
    <h1>LLM ↔ Assembly 기반 1회성 시그니처 인증 — 다이어그램 & 데모</h1>
    <div class="small">흐름: Assembly → LLM API → 시그니처 추출 → 저수준 조작 → DB 논리 패턴 검사 → Swift/Java/Kotlin 역매핑 인증</div>
  </div>
</header>

<div class="container">
  <div class="card">
    <h3>흐름 다이어그램</h3>
    <svg viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="6" refY="5" orient="auto">
          <path d="M0 0 L10 5 L0 10 z" fill="#0f172a" />
        </marker>
      </defs>
      <rect x="20" y="20" width="160" height="60" rx="8" fill="#f1f5f9" stroke="#cbd5e1" />
      <text x="100" y="55" font-size="12" text-anchor="middle" fill="#0f172a">Assembly 레이어</text>

      <rect x="220" y="20" width="180" height="60" rx="8" fill="#fff7ed" stroke="#f1c40f" />
      <text x="310" y="39" font-size="12" text-anchor="middle" fill="#92400e">LLM API (Mock)</text>
      <text x="310" y="55" font-size="11" text-anchor="middle" fill="#92400e">{sig_low, sig_high} 반환</text>

      <rect x="460" y="20" width="160" height="60" rx="8" fill="#eef2ff" stroke="#c7d2fe" />
      <text x="540" y="55" font-size="12" text-anchor="middle" fill="#1e293b">어셈블리 파서 & 조작기</text>

      <line x1="180" y1="50" x2="220" y2="50" stroke="#0f172a" marker-end="url(#arrow)" />
      <line x1="400" y1="50" x2="460" y2="50" stroke="#0f172a" marker-end="url(#arrow)" />

      <rect x="100" y="120" width="240" height="60" rx="8" fill="#ecfdf5" stroke="#a7f3d0" />
      <text x="220" y="150" font-size="12" text-anchor="middle" fill="#065f46">DB: 논리 패턴 매칭</text>

      <line x1="540" y1="80" x2="340" y2="120" stroke="#0f172a" marker-end="url(#arrow)" />

      <rect x="420" y="220" width="320" height="100" rx="8" fill="#fff1f2" stroke="#fecaca" />
      <text x="580" y="250" font-size="12" text-anchor="middle" fill="#7f1d1d">역매핑 → Swift/Java/Kotlin 코드 생성</text>
      <text x="580" y="270" font-size="11" text-anchor="middle" fill="#7f1d1d">(사람이 읽기 쉬운 인증 코드)</text>

      <line x1="220" y1="150" x2="420" y2="260" stroke="#0f172a" marker-end="url(#arrow)" />

      <rect x="20" y="220" width="360" height="100" rx="8" fill="#f8fafc" stroke="#e2e8f0" />
      <text x="200" y="250" font-size="12" text-anchor="middle" fill="#0f172a">로그 저장</text>
      <text x="200" y="270" font-size="11" text-anchor="middle" fill="#0f172a">해시·타임스탬프만 기록</text>

      <line x1="640" y1="260" x2="640" y2="220" stroke="#0f172a" marker-end="url(#arrow)" />
      <line x1="200" y1="180" x2="200" y2="220" stroke="#0f172a" marker-end="url(#arrow)" />
    </svg>
  </div>

  <div class="card">
    <h1>알고리즘 단계</h1>
    <ol>
      <li>어셈블리 레벨에서 소켓을 열고 LLM API로 POST 요청 전송</li>
      <li>JSON 응답을 수신 후 필요한 키(sig_low, sig_high)만 파싱</li>
      <li>어셈블리(자동화·딥러닝·머신러닝)으로 sig_low 조작</li>
      <li>조작된 토큰을 DB로 전달하여 논리 패턴 매칭 수행</li>
      <li>매칭 성공 시 sig_high를 이용해 사람 친화적 고수준 코드(Swift/Java/Kotlin) 생성</li>
    </ol>

    <h1>보안 환경 가정</h1>
    <ul>
      <li>sig_low는 매 요청마다 달라지는 1회성 값</li>
      <li>어셈블리는 하드웨어 엔트로피(cpuid, timestamp) 사용</li>
      <li>DB는 원본 시그니처가 아닌 패턴 해시만 저장</li>
    </ul>
  </div>
</div>

<script>
const logEl = document.getElementById('log');
const outEl = document.getElementById('out');
function log(s){ logEl.innerText += '\n' + s; logEl.scrollTop = logEl.scrollHeight }
function reset(){ logEl.innerText=''; outEl.innerText='(비어 있음)'; }

function mockLLM(){
  const nonce = Math.floor(Math.random()*1e9).toString(16);
  const sigLow = sha1Hex('modelseed:'+Date.now()+':'+nonce).slice(0,16);
  const sigHigh = sha1Hex('high:'+nonce).slice(0,16);
  return {sig_low:sigLow, sig_high:sigHigh};
}

function sha1Hex(s){
  let h0=0x67452301,h1=0xEFCDAB89,h2=0x98BADCFE,h3=0x10325476,h4=0xC3D2E1F0;
  const words=[];
  for(let i=0;i<s.length;i++)words[i>>2]|=s.charCodeAt(i)<<(24-(i%4)*8);
  words[s.length>>2]|=0x80<<(24-(s.length%4)*8);
  words[(((s.length+8)>>6)<<4)+15]=s.length*8;
  for(let i=0;i<words.length;i+=16){
    const w=words.slice(i,i+16);
    for(let j=16;j<80;j++){
      const t=w[j-3]^w[j-8]^w[j-14]^w[j-16];
      w[j]=(t<<1)|(t>>>31);
    }
    let a=h0,b=h1,c=h2,d=h3,e=h4;
    for(let j=0;j<80;j++){
      let f,k;
      if(j<20){f=(b&c)|((~b)&d);k=0x5A827999}
      else if(j<40){f=b^c^d;k=0x6ED9EBA1}
      else if(j<60){f=(b&c)|(b&d)|(c&d);k=0x8F1BBCDC}
      else{f=b^c^d;k=0xCA62C1D6}
      const temp=((a<<5)|(a>>>27))+f+e+k+(w[j]|0);
      e=d;d=c;c=(b<<30)|(b>>>2);b=a;a=temp;
    }
    h0+=a;h1+=b;h2+=c;h3+=d;h4+=e;
  }
  return [h0,h1,h2,h3,h4].map(x=>(x>>>0).toString(16).padStart(8,'0')).join('');
}
</script>
</body>
</html>